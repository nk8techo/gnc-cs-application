SELECT qurReportingBase.[Project Number], qurReportingBase.DIVISION, qurReportingBase.[Corporate or Franchise], qurReportingBase.[CENTER NAME], qurReportingBase.CITY, qurReportingBase.ST, qurReportingBase.Location, qurReportingBase.Category, qurReportingBase.[Project Manager], qurReportingBase.[Store Planner], qurReportingBase.[Construction Completed], qurReportingBase.Open, tblContract.Pictures, IIf([Construction Completed] Is Not Null,(Date()-([Construction Completed]+45)),(Date()-([Open]+45))) AS [Punchlist Pictures Days Late]
FROM qurReportingBase LEFT JOIN tblContract ON qurReportingBase.[Project Number] = tblContract.[Project Number]
WHERE (((qurReportingBase.[Project Manager])<>"RJ" And (qurReportingBase.[Project Manager])<>"RR") AND ((qurReportingBase.[Construction Completed])<=Date()-45) AND ((tblContract.Pictures)<>"REC'D" And (tblContract.Pictures)<>"N/A") AND ((qurReportingBase.[Project Status])="A") AND ((qurReportingBase.Distribution)<>"S")) OR (((qurReportingBase.[Project Manager])<>"RJ" And (qurReportingBase.[Project Manager])<>"RR") AND ((qurReportingBase.[Construction Completed])<=Date()-45) AND ((tblContract.Pictures) Is Null) AND ((qurReportingBase.[Project Status])="A") AND ((qurReportingBase.Distribution)<>"S")) OR (((qurReportingBase.[Project Manager])<>"RJ" And (qurReportingBase.[Project Manager])<>"RR") AND ((qurReportingBase.[Construction Completed]) Is Null) AND ((qurReportingBase.Open)<=Date()-45) AND ((tblContract.Pictures)<>"REC'D" And (tblContract.Pictures)<>"N/A") AND ((qurReportingBase.[Project Status])="A") AND ((qurReportingBase.Distribution)<>"S")) OR (((qurReportingBase.[Project Manager])<>"RJ" And (qurReportingBase.[Project Manager])<>"RR") AND ((qurReportingBase.[Construction Completed]) Is Null) AND ((qurReportingBase.Open)<=Date()-45) AND ((tblContract.Pictures) Is Null) AND ((qurReportingBase.[Project Status])="A") AND ((qurReportingBase.Distribution)<>"S"));

